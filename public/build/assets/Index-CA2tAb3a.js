import{j as e,r,L as _}from"./app-BdSiAjyP.js";import{C as q}from"./card-CNemksZq.js";import{C as H,a as Q,T as U}from"./toast-CmT7txdK.js";import{c as g,b as Z,B as K}from"./leaf-DbhNcTOD.js";import{A as T}from"./app-layout-DfYskyfE.js";import{s as y,R as ee,F as te,l as v}from"./form-prediction-B45qi9AV.js";import"./index-BWqvCfnA.js";import"./index-Da7dyP6f.js";import"./index-A8wZ14uY.js";import"./Combination-D340P4z7.js";import"./index-CdHozyMW.js";import"./input-error-Chbo7qiN.js";import"./select-DcjTyB4S.js";import"./index-DdAhsHyQ.js";const R=({className:t,...a})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:g("mx-auto flex w-full justify-center",t),...a});R.displayName="Pagination";const z=r.forwardRef(({className:t,...a},l)=>e.jsx("ul",{ref:l,className:g("flex flex-row items-center gap-1",t),...a}));z.displayName="PaginationContent";const P=r.forwardRef(({className:t,...a},l)=>e.jsx("li",{ref:l,className:g("",t),...a}));P.displayName="PaginationItem";const A=({className:t,isActive:a,size:l="icon",...u})=>e.jsx("a",{"aria-current":a?"page":void 0,className:g(Z({variant:a?"outline":"ghost",size:l}),t),...u});A.displayName="PaginationLink";const F=({className:t,...a})=>e.jsxs(A,{"aria-label":"Go to previous page",size:"default",className:g("gap-1 pr-2.5 w-max",t),...a,children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:"Sebelumnya"})]});F.displayName="PaginationPrevious";const Y=({className:t,...a})=>e.jsxs(A,{"aria-label":"Go to next page",size:"default",className:g("gap-1 pl-2.5 w-max",t),...a,children:[e.jsx("span",{children:"Selanjutnya"}),e.jsx(Q,{className:"h-4 w-4"})]});Y.displayName="PaginationNext";function ae({indikator:t,transactionX:a,transactionY:l,onModelsTrained:u}){const[f,S]=r.useState({title:"",text:"",status:!1,variant:"default"}),[E,j]=r.useState(!1),[N,L]=r.useState(!1),[G,O]=r.useState({ph:0,ppm:0,ketinggianAir:0,label:0}),p=()=>{const d={seed:42,maxFeatures:2,replacement:!0,nEstimators:100,useSampleBagging:!0};return new ee(d)},b=async()=>{L(!0);try{if(!Array.isArray(a)||!Array.isArray(l))throw new Error("transactionX atau transactionY bukan array");if(a.length===0||l.length===0)throw new Error("Data training (transactionX atau transactionY) kosong");if(a.length!==l.length)throw new Error(`Jumlah data tidak konsisten. transactionX: ${a.length}, transactionY: ${l.length}`);const d=a,h={ph:p(),ppm:p(),ketinggianAir:p(),label:p()},k=async(n,m)=>{try{const c=l.map(M=>M[m]);if(c.length===0)throw new Error(`Tidak ada data untuk output: ${m}`);return console.log(`Training model ${m} dengan ${d.length} samples`),n.train(d,c),n}catch(c){throw console.error(`Error training model ${m}:`,c),new Error(`Gagal training model ${m}: ${c}`)}},[w,$,C,I]=await Promise.all([k(h.ph,"ph"),k(h.ppm,"ppm"),k(h.ketinggianAir,"ketinggianAir"),k(h.label,"label")]);try{await Promise.all([y(w,"ph",t),y($,"ppm",t),y(C,"ketinggianAir",t),y(I,"label",t)]),S({title:"Berhasil",text:"Model Berhasil Dilatih",status:!0,variant:"default"}),j(!0)}catch(n){console.error("Error saving models:",n)}}catch(d){console.error("Error in trainAllModels:",d),S({title:"Terjadi Kesalahan Ketika Melatih Model",text:`Gagal melakukan training model: ${d}`,status:!0,variant:"error"}),j(!0)}finally{L(!1)}};return e.jsxs("div",{className:"rounded-lg border bg-gray-50 p-6",children:[e.jsx(U,{open:E,onOpenChange:j,title:f.title,description:f.text,variant:f.variant}),e.jsx("h3",{className:"mb-4 text-lg font-semibold",children:"Mulai Pelatihan Model"}),e.jsx(K,{onClick:b,disabled:N,className:"mt-4 w-full",children:N?"Melatih Semua Model...":"Latih Model"})]})}function ke({dataTraining:t,breadcrumb:a,titlePage:l,kriteria:u,jenisTanaman:f,opsiLabel:S,opsiGejala:E}){const j=r.useMemo(()=>a?a.map(s=>({title:s.title,href:s.href})):[],[a]),[N,L]=r.useState(!1),[G,O]=r.useState({text:"",status:!1}),[p,b]=r.useState({ph:null,ppm:null,ketinggianAir:null,label:null}),[d,h]=r.useState(null),[k,w]=r.useState(!1),[$,C]=r.useState(u??[]),I=(s,o)=>{b(s),h(o)};r.useEffect(()=>{(async()=>{w(!0);try{const[{indikator:o,model:i},{indikator:B,model:J},{indikator:se,model:X},{indikator:re,model:W}]=await Promise.all([v("ph"),v("ppm"),v("ketinggianAir"),v("label")]);C(o),b({ph:i,ppm:J,ketinggianAir:X,label:W})}finally{w(!1)}})()},[]);const[n,m]=r.useState(1),c=5,M=n*c,D=M-c,V=t==null?void 0:t.training.slice(D,M),x=Math.ceil((t==null?void 0:t.training.length)/c);return e.jsxs(T,{breadcrumbs:j,children:[e.jsx(_,{title:l??"Indikator"}),e.jsxs(q,{children:[t&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-md mb-2 font-semibold",children:"Data Training"}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full border bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2",children:"No."}),t.kriteria.map((s,o)=>e.jsx("th",{className:"border px-4 py-2",children:s},o)),e.jsx("th",{className:"border px-4 py-2",children:"Jenis Tanaman"})]})}),e.jsx("tbody",{children:V.map((s,o)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"border px-4 py-2",children:[" ",D+o+1]}),s.map((i,B)=>e.jsx("td",{className:"border px-4 py-2",children:i},B))]},o))})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"order-2 text-xs text-gray-500 sm:order-1 md:text-sm whitespace-nowrap",children:["Showing ",D+1," to ",Math.min(M,t.training.length)," of"," ",t.training.length," entries"]}),e.jsx(R,{className:"order-1 sm:order-2",children:e.jsxs(z,{className:"flex-wrap justify-center",children:[e.jsx(P,{children:e.jsx(F,{onClick:()=>m(Math.max(1,n-1)),className:n===1?"pointer-events-none opacity-50":"",size:void 0})}),Array.from({length:Math.min(x,5)},(s,o)=>{let i;return x<=5||n<=3?i=o+1:n>=x-2?i=x-4+o:i=n-2+o,e.jsx(P,{children:e.jsx(A,{isActive:i===n,onClick:()=>m(i),size:void 0,children:i})},i)}),e.jsx(P,{children:e.jsx(Y,{onClick:()=>m(Math.min(x,n+1)),className:n===x?"pointer-events-none opacity-50":"",size:void 0})})]})})]})]})]}),t.training.length>5&&u.length>0&&!N?e.jsx(ae,{indikator:t.kriteria,transactionX:t.training,transactionY:t.transactionY,onModelsTrained:I}):e.jsx("div",{className:"rounded-lg bg-white p-6 shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Data tidak cukup"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Data panen harus lebih dari lima agar model dapat diuji. Silakan tambahkan data panen terlebih dahulu."})]})}),p&&e.jsx(te,{models:p,normalizationParams:d,opsiGejala:E,jenisTanaman:f,indikator:t.kriteria,transactionX:t.training,actualData:{ph:t.transactionY.map(s=>s.ph),ppm:t.transactionY.map(s=>s.ppm),ketinggianAir:t.transactionY.map(s=>s.ketinggianAir),label:t.transactionY.map(s=>s.label)}})]})]})}export{ke as default};
